# 1124 3주차 목요일

목요일은 피곤하다. 오늘은 이것 저것 여러 가지의 일로 context switching이 많이 일어나서 더 피로했던 것 같다. 그래도 이번주 초에 올린 PR은 코드 리뷰가 마지막 단계에 접어서 오늘로 거의 끝났다. 🌸

## Unit test

1 on 1 시간에는 unit test를 작성했다.

**100% coverage**가 되어야 한다. 해킹될 여지가 없어야 한다. 그래서 최대한 많은 경우의 수에 대비하는 유닛 테스트를 작성해야 한다. **edge case**를 잘 커버해야한다.

시간이 지난 뒤 상황이 바뀔 수 있고, 내가 그 코드를 담당하지 않게 될 가능성이 높다. 누군가 내가 작성했던 테스트 코드를 (고의로) 피해서 통과하도록 코드를 작성할 수 있다. 

Arrange, Act, Assert로 이루어진 AAA 패턴이란 말이 있다. 준비하는 코드, 함수를 실행하는 코드, 실행 결과를 검사하는 코드 부분이 명확해야 한다는 것이 핵심이다.

Arrange 과정이 쉬울수록 코드를 잘 썼을 가능성이 높다. 가능성이 높다는 것이지 꼭 그렇다는 뜻은 아니다. 이는 interface가 넓은가를 판단하는 지표가 되기도 한다.

테스트 코드에는 조건을 넣으면 안된다. 만약 조건은 넣는다면 테스트를 위한 테스트 코드를 또 작성해야 한다. 테스트 코드에 조건이 들어갈 수 있는 경우는 범용적으로 사용되는 테스트 헬퍼 함수들 뿐이다.

다른 모듈은 잘 동작한다고 가정한다. mock 객체를 만들어서 의도한 대로 동작한다고 가정하는 것을 말한다. 그런데 이 부분은 요즘 논란의 여지가 있는 부분이다.

## 영어

솔직히 영어는 감대로 썼고 멋대로 쓰는 것 같다. 번역기를 참고하지만 한국어부터 잘 못한다... ㅎㅋ 그리고 대문자로 바꾸라고 항상 코칭받는다... 오늘은 영어로 회의감을 많이 느끼는 하루다. 왜냐면 코드 리뷰에서 항상 영어 주석이나 test 제목은 다 바꿔주시기 때문이다... 화상 영어나 글쓰기 교정을 꼭 받으면서 시간을 투자해야지. 영어 때문에 버겁다고 훅 느꼈다.

영어도 코드도 익숙해져서 그냥 자연스럽게 나오는 것. 반복하고 손으로 해보고 눈으로 훑을 줄 알아야 한다.

## Wrapper
AWS SDK를 사용해 DynamoDB에 접근하고 있는데 이 모듈이 굉장히 코드를 지저분하게 한다. 그래서 더 짧은 줄로 핵심 로직에 집중할 수 있도록 wrapper를 만들었다. 또 AWS SDK를 사용해 Go에서 test하는 것은 매우 힘들다. 너무 많은 setting 값이 있기 때문이다. 그래서 wrapper를 도입해 test를 용이하게 할 수 있다.

이미 wrapper를 만들어두셨고 한 프로젝트에 활용한 코드가 있다. 그것을 바탕으로 다른 프로젝트에 wrapper로 변경하는 업무를 했다. **각 상황에 맞는 error로 처리**되었는지 확인하자.

수정은 없는 노트 서비스에서 사용하고 있는 key 값이다. 조금 더 파악이 필요할 것 같다.
```
C: item.id
R: item.id
R(여러개): user.id 
U: 
D: item.id, user.id
```
